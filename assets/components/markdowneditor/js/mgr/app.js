var MarkdownEditor=function(e){e=e||{},MarkdownEditor.superclass.constructor.call(this,e)};Ext.override(MODx.panel.Resource,{}),Ext.extend(MarkdownEditor,Ext.Component,{initComponent:function(){MarkdownEditor.superclass.initComponent.call(this),Ext.onReady(this.render,this)},buildUI:function(){this.textarea.setDisplayed("none"),this.textarea.setWidth(0),this.textarea.setHeight(0);var e=Ext.DomHelper.insertBefore(this.textarea,{tag:"div","class":"markdown-container"});Ext.DomHelper.append(e,{tag:"div",id:"content-md","class":this.textarea.dom.className}),Ext.DomHelper.append(e,{tag:"div",id:"preview-md","class":"markdown-body"}),Ext.DomHelper.append(e,{tag:"div",id:"toolbox",cn:[{tag:"span",id:"preview-button",html:'<i class="icon icon-toggle-off"></i> Preview'},{tag:"span",id:"fullscreen-button",html:'<i class="icon icon-expand"></i>'}]}),Ext.DomHelper.append(e,{tag:"span",style:"clear: both"})},registerAce:function(){this.editor=ace.edit(Ext.DomQuery.selectNode("div#content-md")),this.editor.setOptions({maxLines:1/0,minLines:25,showPrintMargin:!1,autoScrollEditorIntoView:!0}),this.editor.renderer.setShowGutter(!0),this.editor.renderer.setScrollMargin(10,10),this.editor.getSession().setValue(this.textarea.getValue()),this.editor.getSession().setMode("ace/mode/markdown"),this.editor.setTheme("ace/theme/monokai"),console.log("test")},languageOverrides:{js:"javascript",html:"xml"},registerMarked:function(){var e=this,t=new marked.Renderer;t.code=function(e,t,i){if(this.options.highlight){var s=this.options.highlight(e,t);null!=s&&s!==e&&(i=!0,e=s)}return t?'<pre><code class="hljs '+this.options.langPrefix+escape(t,!0)+'">'+(i?e:escape(e,!0))+"\n</code></pre>\n":"<pre><code>"+(i?e:escape(e,!0))+"\n</code></pre>"},marked.setOptions({highlight:function(t,i){return e.languageOverrides[i]&&(i=e.languageOverrides[i]),-1!=hljs.listLanguages().indexOf(i)?hljs.highlight(i,t).value:t},renderer:t})},render:function(){var e=this;this.textarea=Ext.get("ta"),this.buildUI(),this.registerAce(),this.registerMarked();var t=Ext.get("preview-button"),i=Ext.get("fullscreen-button"),s=Ext.get("preview-md"),o=Ext.get("content-md"),n=o.parent(),r=MODx.load({xtype:"modx-treedrop",target:o,targetEl:o,onInsert:function(e){return this.insert(e),this.focus(),!0}.bind(this.editor),iframe:!0});this.textarea.on("destroy",function(){r.destroy()}),t.addListener("click",function(){s.isVisible()?(s.setDisplayed("none"),o.setDisplayed("block"),t.child("i").removeClass("icon-toggle-on"),t.child("i").addClass("icon-toggle-off")):(s.setDisplayed("block"),o.setDisplayed("none"),t.child("i").removeClass("icon-toggle-off"),t.child("i").addClass("icon-toggle-on"))}),i.addListener("click",function(){var e=i.child("i");e.hasClass("icon-expand")?(e.removeClass("icon-expand"),e.addClass("icon-compress"),s.setDisplayed("block"),o.setDisplayed("block"),t.hide(),n.addClass("fullscreen"),this.editor.setOption("maxLines",null)):(e.addClass("icon-expand"),e.removeClass("icon-compress"),s.setDisplayed("none"),o.setDisplayed("block"),t.show(),n.removeClass("fullscreen"),this.editor.setOption("maxLines",1/0))},this),s.update(marked(this.editor.getValue())),this.editor.getSession().on("change",function(){s.update(marked(e.editor.getValue()))})}}),MarkdownEditor=new MarkdownEditor;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxHQUFBLGdCQUFBLFNBQUEsR0FDQSxFQUFBLE1BQ0EsZUFBQSxXQUFBLFlBQUEsS0FBQSxLQUFBLEdBRUEsS0FBQSxTQUFBLEtBQUEsTUFBQSxhQUVBLElBQUEsT0FBQSxlQUFBLElBQUEsV0FDQSxjQUFBLFdBQ0EsZUFBQSxXQUFBLGNBQUEsS0FBQSxNQUVBLElBQUEsUUFBQSxLQUFBLE9BQUEsT0FHQSxRQUFBLFdBQ0EsS0FBQSxTQUFBLGFBQUEsUUFDQSxLQUFBLFNBQUEsU0FBQSxHQUNBLEtBQUEsU0FBQSxVQUFBLEVBRUEsSUFBQSxHQUFBLElBQUEsVUFBQSxhQUFBLEtBQUEsVUFDQSxJQUFBLE1BQ0EsUUFBQSxzQkFHQSxLQUFBLFVBQUEsT0FBQSxHQUNBLElBQUEsTUFDQSxHQUFBLGFBQ0EsUUFBQSxLQUFBLFNBQUEsSUFBQSxZQUdBLElBQUEsVUFBQSxPQUFBLEdBQ0EsSUFBQSxNQUNBLEdBQUEsYUFDQSxRQUFBLGtCQUdBLElBQUEsVUFBQSxPQUFBLEdBQ0EsSUFBQSxNQUNBLEdBQUEsVUFDQSxLQUNBLElBQUEsT0FDQSxHQUFBLGlCQUNBLEtBQUEsaURBRUEsSUFBQSxPQUNBLEdBQUEsb0JBQ0EsS0FBQSx1Q0FJQSxJQUFBLFVBQUEsT0FBQSxHQUNBLElBQUEsT0FDQSxNQUFBLGlCQUlBLFlBQUEsV0FFQSxLQUFBLE9BQUEsSUFBQSxLQUFBLElBQUEsU0FBQSxXQUFBLG1CQUNBLEtBQUEsT0FBQSxZQUNBLFNBQUEsSUFDQSxTQUFBLEdBQ0EsaUJBQUEsRUFDQSwwQkFBQSxJQUVBLEtBQUEsT0FBQSxTQUFBLGVBQUEsR0FDQSxLQUFBLE9BQUEsU0FBQSxnQkFBQSxHQUFBLElBQ0EsS0FBQSxPQUFBLGFBQUEsU0FBQSxLQUFBLFNBQUEsWUFDQSxLQUFBLE9BQUEsYUFBQSxRQUFBLHFCQUNBLEtBQUEsT0FBQSxTQUFBLHFCQUVBLFFBQUEsSUFBQSxTQUdBLG1CQUNBLEdBQUEsYUFDQSxLQUFBLE9BR0EsZUFBQSxXQUNBLEdBQUEsR0FBQSxLQUNBLEVBQUEsR0FBQSxRQUFBLFFBRUEsR0FBQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsR0FBQSxLQUFBLFFBQUEsVUFBQSxDQUNBLEdBQUEsR0FBQSxLQUFBLFFBQUEsVUFBQSxFQUFBLEVBQ0EsT0FBQSxHQUFBLElBQUEsSUFDQSxHQUFBLEVBQ0EsRUFBQSxHQUlBLE1BQUEsR0FNQSwwQkFDQSxLQUFBLFFBQUEsV0FDQSxPQUFBLEdBQUEsR0FDQSxNQUNBLEVBQUEsRUFBQSxPQUFBLEdBQUEsSUFDQSxvQkFWQSxlQUNBLEVBQUEsRUFBQSxPQUFBLEdBQUEsSUFDQSxtQkFXQSxPQUFBLFlBQ0EsVUFBQSxTQUFBLEVBQUEsR0FFQSxNQURBLEdBQUEsa0JBQUEsS0FBQSxFQUFBLEVBQUEsa0JBQUEsSUFDQSxJQUFBLEtBQUEsZ0JBQUEsUUFBQSxHQUFBLEtBQUEsVUFBQSxFQUFBLEdBQUEsTUFBQSxHQUVBLFNBQUEsS0FJQSxPQUFBLFdBQ0EsR0FBQSxHQUFBLElBQ0EsTUFBQSxTQUFBLElBQUEsSUFBQSxNQUVBLEtBQUEsVUFDQSxLQUFBLGNBQ0EsS0FBQSxnQkFVQSxJQUFBLEdBQUEsSUFBQSxJQUFBLGtCQUNBLEVBQUEsSUFBQSxJQUFBLHFCQUNBLEVBQUEsSUFBQSxJQUFBLGNBQ0EsRUFBQSxJQUFBLElBQUEsY0FDQSxFQUFBLEVBQUEsU0FFQSxFQUFBLEtBQUEsTUFDQSxNQUFBLGdCQUNBLE9BQUEsRUFDQSxTQUFBLEVBQ0EsU0FBQSxTQUFBLEdBR0EsTUFGQSxNQUFBLE9BQUEsR0FDQSxLQUFBLFNBQ0EsR0FDQSxLQUFBLEtBQUEsUUFDQSxRQUFBLEdBRUEsTUFBQSxTQUFBLEdBQUEsVUFBQSxXQUFBLEVBQUEsWUFFQSxFQUFBLFlBQUEsUUFBQSxXQUNBLEVBQUEsYUFDQSxFQUFBLGFBQUEsUUFDQSxFQUFBLGFBQUEsU0FFQSxFQUFBLE1BQUEsS0FBQSxZQUFBLGtCQUNBLEVBQUEsTUFBQSxLQUFBLFNBQUEscUJBRUEsRUFBQSxhQUFBLFNBQ0EsRUFBQSxhQUFBLFFBRUEsRUFBQSxNQUFBLEtBQUEsWUFBQSxtQkFDQSxFQUFBLE1BQUEsS0FBQSxTQUFBLHFCQUlBLEVBQUEsWUFBQSxRQUFBLFdBQ0EsR0FBQSxHQUFBLEVBQUEsTUFBQSxJQUVBLEdBQUEsU0FBQSxnQkFDQSxFQUFBLFlBQUEsZUFDQSxFQUFBLFNBQUEsaUJBRUEsRUFBQSxhQUFBLFNBQ0EsRUFBQSxhQUFBLFNBRUEsRUFBQSxPQUVBLEVBQUEsU0FBQSxjQUVBLEtBQUEsT0FBQSxVQUFBLFdBQUEsUUFFQSxFQUFBLFNBQUEsZUFDQSxFQUFBLFlBQUEsaUJBRUEsRUFBQSxhQUFBLFFBQ0EsRUFBQSxhQUFBLFNBRUEsRUFBQSxPQUVBLEVBQUEsWUFBQSxjQUVBLEtBQUEsT0FBQSxVQUFBLFdBQUEsT0FFQSxNQUVBLEVBQUEsT0FBQSxPQUFBLEtBQUEsT0FBQSxhQUNBLEtBQUEsT0FBQSxhQUFBLEdBQUEsU0FBQSxXQUNBLEVBQUEsT0FBQSxPQUFBLEVBQUEsT0FBQSxrQkFJQSxlQUFBLEdBQUEiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIE1hcmtkb3duRWRpdG9yID0gZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgY29uZmlnID0gY29uZmlnIHx8IHt9O1xuICAgIE1hcmtkb3duRWRpdG9yLnN1cGVyY2xhc3MuY29uc3RydWN0b3IuY2FsbCh0aGlzLGNvbmZpZyk7XG59O1xuRXh0Lm92ZXJyaWRlKE1PRHgucGFuZWwuUmVzb3VyY2UsIHt9KTtcblxuRXh0LmV4dGVuZChNYXJrZG93bkVkaXRvcixFeHQuQ29tcG9uZW50LHtcbiAgICBpbml0Q29tcG9uZW50OiBmdW5jdGlvbigpIHtcbiAgICAgICAgTWFya2Rvd25FZGl0b3Iuc3VwZXJjbGFzcy5pbml0Q29tcG9uZW50LmNhbGwodGhpcyk7XG5cbiAgICAgICAgRXh0Lm9uUmVhZHkodGhpcy5yZW5kZXIsIHRoaXMpO1xuICAgIH1cblxuICAgICxidWlsZFVJOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy50ZXh0YXJlYS5zZXREaXNwbGF5ZWQoJ25vbmUnKTtcbiAgICAgICAgdGhpcy50ZXh0YXJlYS5zZXRXaWR0aCgwKTtcbiAgICAgICAgdGhpcy50ZXh0YXJlYS5zZXRIZWlnaHQoMCk7XG5cbiAgICAgICAgdmFyIHdyYXBwZXIgPSBFeHQuRG9tSGVscGVyLmluc2VydEJlZm9yZSh0aGlzLnRleHRhcmVhLCB7XG4gICAgICAgICAgICB0YWc6ICdkaXYnLFxuICAgICAgICAgICAgY2xhc3M6ICdtYXJrZG93bi1jb250YWluZXInXG4gICAgICAgIH0pO1xuXG4gICAgICAgIEV4dC5Eb21IZWxwZXIuYXBwZW5kKHdyYXBwZXIse1xuICAgICAgICAgICAgdGFnOiAnZGl2JyxcbiAgICAgICAgICAgIGlkOiAnY29udGVudC1tZCcsXG4gICAgICAgICAgICBjbGFzczogdGhpcy50ZXh0YXJlYS5kb20uY2xhc3NOYW1lXG4gICAgICAgIH0pO1xuXG4gICAgICAgIEV4dC5Eb21IZWxwZXIuYXBwZW5kKHdyYXBwZXIse1xuICAgICAgICAgICAgdGFnOiAnZGl2JyxcbiAgICAgICAgICAgIGlkOiAncHJldmlldy1tZCcsXG4gICAgICAgICAgICBjbGFzczogJ21hcmtkb3duLWJvZHknXG4gICAgICAgIH0pO1xuXG4gICAgICAgIEV4dC5Eb21IZWxwZXIuYXBwZW5kKHdyYXBwZXIse1xuICAgICAgICAgICAgdGFnOiAnZGl2JyxcbiAgICAgICAgICAgIGlkOiAndG9vbGJveCcsXG4gICAgICAgICAgICBjbjogW3tcbiAgICAgICAgICAgICAgICB0YWc6ICdzcGFuJyxcbiAgICAgICAgICAgICAgICBpZDogJ3ByZXZpZXctYnV0dG9uJyxcbiAgICAgICAgICAgICAgICBodG1sOiAnPGkgY2xhc3M9XCJpY29uIGljb24tdG9nZ2xlLW9mZlwiPjwvaT4gUHJldmlldydcbiAgICAgICAgICAgIH0se1xuICAgICAgICAgICAgICAgIHRhZzogJ3NwYW4nLFxuICAgICAgICAgICAgICAgIGlkOiAnZnVsbHNjcmVlbi1idXR0b24nLFxuICAgICAgICAgICAgICAgIGh0bWw6ICc8aSBjbGFzcz1cImljb24gaWNvbi1leHBhbmRcIj48L2k+J1xuICAgICAgICAgICAgfV1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgRXh0LkRvbUhlbHBlci5hcHBlbmQod3JhcHBlcix7XG4gICAgICAgICAgICB0YWc6ICdzcGFuJyxcbiAgICAgICAgICAgIHN0eWxlOiAnY2xlYXI6IGJvdGgnLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAscmVnaXN0ZXJBY2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgbWRlID0gdGhpcztcbiAgICAgICAgdGhpcy5lZGl0b3IgPSBhY2UuZWRpdChFeHQuRG9tUXVlcnkuc2VsZWN0Tm9kZSgnZGl2I2NvbnRlbnQtbWQnKSk7XG4gICAgICAgIHRoaXMuZWRpdG9yLnNldE9wdGlvbnMoe1xuICAgICAgICAgICAgbWF4TGluZXM6IEluZmluaXR5LFxuICAgICAgICAgICAgbWluTGluZXM6IDI1LFxuICAgICAgICAgICAgc2hvd1ByaW50TWFyZ2luOiBmYWxzZSxcbiAgICAgICAgICAgIGF1dG9TY3JvbGxFZGl0b3JJbnRvVmlldzogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5lZGl0b3IucmVuZGVyZXIuc2V0U2hvd0d1dHRlcih0cnVlKTtcbiAgICAgICAgdGhpcy5lZGl0b3IucmVuZGVyZXIuc2V0U2Nyb2xsTWFyZ2luKDEwLCAxMCk7XG4gICAgICAgIHRoaXMuZWRpdG9yLmdldFNlc3Npb24oKS5zZXRWYWx1ZSh0aGlzLnRleHRhcmVhLmdldFZhbHVlKCkpO1xuICAgICAgICB0aGlzLmVkaXRvci5nZXRTZXNzaW9uKCkuc2V0TW9kZShcImFjZS9tb2RlL21hcmtkb3duXCIpO1xuICAgICAgICB0aGlzLmVkaXRvci5zZXRUaGVtZShcImFjZS90aGVtZS9tb25va2FpXCIpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCd0ZXN0Jyk7XG4gICAgfVxuXG4gICAgLGxhbmd1YWdlT3ZlcnJpZGVzOiB7XG4gICAgICAgIGpzOiAnamF2YXNjcmlwdCdcbiAgICAgICAgLGh0bWw6ICd4bWwnXG4gICAgfVxuXG4gICAgLHJlZ2lzdGVyTWFya2VkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG1kZSA9IHRoaXM7XG4gICAgICAgIHZhciByZW5kZXJlciA9IG5ldyBtYXJrZWQuUmVuZGVyZXIoKTtcblxuICAgICAgICByZW5kZXJlci5jb2RlID0gZnVuY3Rpb24oY29kZSwgbGFuZywgZXNjYXBlZCkge1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5oaWdobGlnaHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3V0ID0gdGhpcy5vcHRpb25zLmhpZ2hsaWdodChjb2RlLCBsYW5nKTtcbiAgICAgICAgICAgICAgICBpZiAob3V0ICE9IG51bGwgJiYgb3V0ICE9PSBjb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGVzY2FwZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjb2RlID0gb3V0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFsYW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICc8cHJlPjxjb2RlPidcbiAgICAgICAgICAgICAgICArIChlc2NhcGVkID8gY29kZSA6IGVzY2FwZShjb2RlLCB0cnVlKSlcbiAgICAgICAgICAgICAgICArICdcXG48L2NvZGU+PC9wcmU+JztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuICc8cHJlPjxjb2RlIGNsYXNzPVwiaGxqcyAnXG4gICAgICAgICAgICArIHRoaXMub3B0aW9ucy5sYW5nUHJlZml4XG4gICAgICAgICAgICArIGVzY2FwZShsYW5nLCB0cnVlKVxuICAgICAgICAgICAgKyAnXCI+J1xuICAgICAgICAgICAgKyAoZXNjYXBlZCA/IGNvZGUgOiBlc2NhcGUoY29kZSwgdHJ1ZSkpXG4gICAgICAgICAgICArICdcXG48L2NvZGU+PC9wcmU+XFxuJztcbiAgICAgICAgfTtcblxuICAgICAgICBtYXJrZWQuc2V0T3B0aW9ucyh7XG4gICAgICAgICAgICBoaWdobGlnaHQ6IGZ1bmN0aW9uKGNvZGUsIGxhbmcpe1xuICAgICAgICAgICAgICAgIGlmKG1kZS5sYW5ndWFnZU92ZXJyaWRlc1tsYW5nXSkgbGFuZyA9IG1kZS5sYW5ndWFnZU92ZXJyaWRlc1tsYW5nXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGhsanMubGlzdExhbmd1YWdlcygpLmluZGV4T2YobGFuZykgIT0gLTEpID8gaGxqcy5oaWdobGlnaHQobGFuZywgY29kZSkudmFsdWUgOiBjb2RlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJlbmRlcmVyOiByZW5kZXJlclxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAscmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG1kZSA9IHRoaXM7XG4gICAgICAgIHRoaXMudGV4dGFyZWEgPSBFeHQuZ2V0KCd0YScpO1xuXG4gICAgICAgIHRoaXMuYnVpbGRVSSgpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyQWNlKCk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJNYXJrZWQoKTtcblxuXG4gICAgICAgIC8vIGNvcHkgYmFjayB0byB0ZXh0YXJlYSBvbiBmb3JtIHN1Ym1pdC4uLlxuICAgICAgICAvL3RleHRhcmVhLmNsb3Nlc3QoJ2Zvcm0nKS5zdWJtaXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyAgICB0ZXh0YXJlYS52YWwoZWRpdG9yLmdldFNlc3Npb24oKS5nZXRWYWx1ZSgpKTtcbiAgICAgICAgLy99KTtcblxuXG5cbiAgICAgICAgdmFyIHByZXZpZXdCdXR0b24gPSBFeHQuZ2V0KCdwcmV2aWV3LWJ1dHRvbicpO1xuICAgICAgICB2YXIgZnVsbHNjcmVlbkJ1dHRvbiA9IEV4dC5nZXQoJ2Z1bGxzY3JlZW4tYnV0dG9uJyk7XG4gICAgICAgIHZhciBwcmV2aWV3ID0gRXh0LmdldCgncHJldmlldy1tZCcpO1xuICAgICAgICB2YXIgY29udGVudCA9IEV4dC5nZXQoJ2NvbnRlbnQtbWQnKTtcbiAgICAgICAgdmFyIHdyYXBwZXIgPSBjb250ZW50LnBhcmVudCgpO1xuXG4gICAgICAgIHZhciBkcm9wVGFyZ2V0ID0gTU9EeC5sb2FkKHtcbiAgICAgICAgICAgIHh0eXBlOiAnbW9keC10cmVlZHJvcCcsXG4gICAgICAgICAgICB0YXJnZXQ6IGNvbnRlbnQsXG4gICAgICAgICAgICB0YXJnZXRFbDogY29udGVudCxcbiAgICAgICAgICAgIG9uSW5zZXJ0OiAoZnVuY3Rpb24ocyl7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnNlcnQocyk7XG4gICAgICAgICAgICAgICAgdGhpcy5mb2N1cygpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSkuYmluZCh0aGlzLmVkaXRvciksXG4gICAgICAgICAgICBpZnJhbWU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMudGV4dGFyZWEub24oJ2Rlc3Ryb3knLCBmdW5jdGlvbigpIHtkcm9wVGFyZ2V0LmRlc3Ryb3koKTt9KTtcblxuICAgICAgICBwcmV2aWV3QnV0dG9uLmFkZExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChwcmV2aWV3LmlzVmlzaWJsZSgpKSB7XG4gICAgICAgICAgICAgICAgcHJldmlldy5zZXREaXNwbGF5ZWQoJ25vbmUnKTtcbiAgICAgICAgICAgICAgICBjb250ZW50LnNldERpc3BsYXllZCgnYmxvY2snKTtcblxuICAgICAgICAgICAgICAgIHByZXZpZXdCdXR0b24uY2hpbGQoJ2knKS5yZW1vdmVDbGFzcygnaWNvbi10b2dnbGUtb24nKTtcbiAgICAgICAgICAgICAgICBwcmV2aWV3QnV0dG9uLmNoaWxkKCdpJykuYWRkQ2xhc3MoJ2ljb24tdG9nZ2xlLW9mZicpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcmV2aWV3LnNldERpc3BsYXllZCgnYmxvY2snKTtcbiAgICAgICAgICAgICAgICBjb250ZW50LnNldERpc3BsYXllZCgnbm9uZScpO1xuXG4gICAgICAgICAgICAgICAgcHJldmlld0J1dHRvbi5jaGlsZCgnaScpLnJlbW92ZUNsYXNzKCdpY29uLXRvZ2dsZS1vZmYnKTtcbiAgICAgICAgICAgICAgICBwcmV2aWV3QnV0dG9uLmNoaWxkKCdpJykuYWRkQ2xhc3MoJ2ljb24tdG9nZ2xlLW9uJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bGxzY3JlZW5CdXR0b24uYWRkTGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGljb24gPSBmdWxsc2NyZWVuQnV0dG9uLmNoaWxkKCdpJyk7XG5cbiAgICAgICAgICAgIGlmIChpY29uLmhhc0NsYXNzKCdpY29uLWV4cGFuZCcpKSB7XG4gICAgICAgICAgICAgICAgaWNvbi5yZW1vdmVDbGFzcygnaWNvbi1leHBhbmQnKTtcbiAgICAgICAgICAgICAgICBpY29uLmFkZENsYXNzKCdpY29uLWNvbXByZXNzJyk7XG5cbiAgICAgICAgICAgICAgICBwcmV2aWV3LnNldERpc3BsYXllZCgnYmxvY2snKTtcbiAgICAgICAgICAgICAgICBjb250ZW50LnNldERpc3BsYXllZCgnYmxvY2snKTtcblxuICAgICAgICAgICAgICAgIHByZXZpZXdCdXR0b24uaGlkZSgpO1xuXG4gICAgICAgICAgICAgICAgd3JhcHBlci5hZGRDbGFzcygnZnVsbHNjcmVlbicpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0b3Iuc2V0T3B0aW9uKCdtYXhMaW5lcycsIG51bGwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpY29uLmFkZENsYXNzKCdpY29uLWV4cGFuZCcpO1xuICAgICAgICAgICAgICAgIGljb24ucmVtb3ZlQ2xhc3MoJ2ljb24tY29tcHJlc3MnKTtcblxuICAgICAgICAgICAgICAgIHByZXZpZXcuc2V0RGlzcGxheWVkKCdub25lJyk7XG4gICAgICAgICAgICAgICAgY29udGVudC5zZXREaXNwbGF5ZWQoJ2Jsb2NrJyk7XG5cbiAgICAgICAgICAgICAgICBwcmV2aWV3QnV0dG9uLnNob3coKTtcblxuICAgICAgICAgICAgICAgIHdyYXBwZXIucmVtb3ZlQ2xhc3MoJ2Z1bGxzY3JlZW4nKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLnNldE9wdGlvbignbWF4TGluZXMnLCBJbmZpbml0eSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgIHByZXZpZXcudXBkYXRlKG1hcmtlZCh0aGlzLmVkaXRvci5nZXRWYWx1ZSgpKSk7XG4gICAgICAgIHRoaXMuZWRpdG9yLmdldFNlc3Npb24oKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHByZXZpZXcudXBkYXRlKG1hcmtlZChtZGUuZWRpdG9yLmdldFZhbHVlKCkpKTtcbiAgICAgICAgfSk7XG4gICAgfVxufSk7XG5NYXJrZG93bkVkaXRvciA9IG5ldyBNYXJrZG93bkVkaXRvcigpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==